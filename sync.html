<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>

    사용자 정의 이벤트는 <span style="color: red;">v-model</span>에서 작동하는 사용자 정의 입력을 만드는데 사용할 수 있다
    <br><br>
    &lt;input v-model="somthing"&gt;<br><br>
    &lt;input<br>
        v-bind:value="somthing"<br>
        v-on:input="somthing = $event.target.value"<br>
    &gt;<br><br>
    &lt;custom-input<br>
        :value="something"<br>
        @input="value => {something = value}"&gt;<br>
    &lt;custom-input&gt;<br>

    <!-- 1 -->
    <div id="app1">
        <currency-input v-model="price"></currency-input>
    </div>

    <!-- -------------------------------------------------------------------- -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <script>

        //1
        Vue.component('currency-input',{
            template:'\
            <span>\
                $\
                <input\
                    ref="input"\
                    v-bind:value="value"\
                    v-on:input="updateValue($event.target.value)">\
            </span>\
            '
            ,props: ['value']
            ,methods: {
                // 값을 직접 업데이트 하지 않고 메소드를 사용하여 입력값에 대한 서식을 지정, 배치
                updateValue: function(value){
                    //console.log(value);
                    //var fv = val.trim().slice(0, value.indexOf('.'))
                    var formattedValue = value
                        .trim()
                        .slice(
                            0,
                            value.indexOf('.') === -1 ? value.length : value.indexOf('.') + 3
                        );
                    // 값이 아직 정규화되지 않은 경우
                    // 이를 수동으로 재정이하여 조건을 충족
                    if(formattedValue !== value){
                        console.log(formattedValue);
                        console.log(value);
                        this.$refs.input.value = formattedValue
                    }
                    // 입력 이벤트를 통해 숫자 값을 보냄
                    this.$emit('input', Number(formattedValue));

                }

            },
        })

        new Vue({
            el: '#app1'
            ,data:{
                price: ""
            }
        })
    
    </script>
    
</body>
</html>